{"version":3,"sources":["webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?f50b","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?690c","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?d71e","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?4148","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?1585","webpack:///I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue?fa68"],"names":["DataFrom","cacheList","cacheOldPrice","components","goodBlock","infoBlock","blockInput","pageFoot","data","totalPrice","totalFreight","list","goodInfo","price","num","total","index","unit","id","good","img","goodName","color","size","methods","getTotalPrice","tmp","forEach","item","inputPay","val","detail","value","getInput","info","sure","canSub","pageLoading","goods","map","test","result","Math","round","bill","dispatch_price","total_price","Request","then","res","Cacher","setData","from","error","closePageLoading","uni","navigateBack","Toast","message","catch","onLoad","option","getData","goodlist","goodsList","order","order_goods","price_unit","title","option_title","len","length","i"],"mappings":"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","file":"pagesBill/pages/changePrice.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport goodBlock from '../components/PriceBlock--Good.vue';\nimport infoBlock from '../components/PriceBlock--Info.vue';\nimport blockInput from '../components/PriceBlock--Input.vue';\nimport pageFoot from '../components/priceBlock--Foot.vue';\nimport {\n    flatten\n} from '../../components/my-components/ajaxDataFormater.js'\nlet DataFrom = {};\nlet cacheList = [];\nlet cacheOldPrice = []; //保存改价前的状态\nexport default {\n    components: {\n        goodBlock,\n        infoBlock,\n        blockInput,\n        pageFoot\n    },\n    data() {\n        return {\n            totalPrice: 0,\n            totalFreight: 0, //统一运费\n            list: [{\n                goodInfo: {\n                    price: '',\n                    num: '',\n                    total: '',\n                    index: 0,\n                    unit: '',\n                    id: ''\n                },\n                good: {\n                    img: '',\n                    goodName: '',\n                    color: '',\n                    size: '',\n                    num: 0,\n                }\n            }]\n        }\n    },\n    methods: {\n        getTotalPrice() {\n            let tmp = 0;\n            cacheList.forEach(item => {\n                tmp += item.goodInfo.total * 1\n            })\n            this.totalPrice = this.totalFreight * 1 + tmp;\n        },\n        inputPay(val) {\n            this.totalFreight = val.detail.value;\n            this.getTotalPrice()\n        },\n        getInput(val) {\n            let index = val.info.index; //商品的index\n            cacheList[index].goodInfo.total = val.value.price;\n            this.getTotalPrice();\n        },\n        sure() {\n            let canSub = true;\n            this.pageLoading();\n            let goods = cacheList.map((item, index) => {\n                if (!/^\\d+(\\.\\d+)?$/.test(item.goodInfo.total)) {\n                    canSub = false;\n                }\n                let result = {\n                    \"id\": item.goodInfo.id, //订单商品id\n                    \"price_change\": Math.round((item.goodInfo.total - cacheOldPrice[index].goodInfo.total) * 100) / 100 //改价变动金额\n                }\n                return result;\n            })\n            if (!/^\\d+(\\.\\d+)?$/.test(this.totalFreight)) {\n                canSub = false;\n            }\n            let data = {\n                id: DataFrom.bill.bill.id, //订单id\n                dispatch_price: this.totalFreight, //运费\n                total_price: this.totalPrice, //订单总价 \n            }\n            goods.forEach((item, index) => {\n                data['change_items[' + index + ']'] = item;\n            })\n            if (canSub) {\n                this.Request('changeBillPrice', flatten(data)).then(res => {\n                    this.Cacher.setData('changePrice', {\n                        from: 'changePrice'\n                    })\n                    if (res.error == 0) {\n                        this.closePageLoading();\n                        uni.navigateBack();\n                        this.Toast('改价成功');\n                    } else {\n                        this.Toast(res.message);\n                    }\n                }).catch(res => {\n                    this.Toast(res.message);\n                })\n            } else {\n                this.closePageLoading();\n                this.Toast('请输入正确的的数字')\n            }\n        }\n    },\n    onLoad(option) {\n        DataFrom = this.Cacher.getData(option.from);\n        let goodlist = DataFrom.bill.goodsList;\n        this.Request('billPrice', {\n            id: DataFrom.bill.bill.id\n        }).then(res => {\n            this.totalFreight = res.order.dispatch_price;\n            cacheList = res.order_goods.map((item, index) => {\n                cacheOldPrice[index] = {\n                    goodInfo: {\n                        total: item.price,\n                        index,\n                        id: item.id\n                    },\n                }\n                let result = {\n                    goodInfo: {\n                        price: item.price_unit,\n                        num: item.total,\n                        total: item.price,\n                        index,\n                        unit: item.unit,\n                        id: item.id\n                    },\n                    good: {\n                        img: '',\n                        goodName: item.title,\n                        color: item.option_title,\n                        size: '',\n                        num: item.total,\n                    }\n                }\n                if (goodlist[index].id == item.id) {\n                    result.good.img = goodlist[index].img;\n                } else {\n                    let len = goodlist.length;\n                    for (let i = 0; i < len; i++) {\n                        if (goodlist[i].id == item.id) {\n                            result.good.img = goodlist[i].img;\n                            break;\n                        }\n                    }\n                }\n                return result;\n            });\n            this.list = cacheList;\n            this.getTotalPrice();\n        })\n    }\n}\n","// extracted by mini-css-extract-plugin","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./changePrice.vue?vue&type=template&id=23c0a7bc&scoped=true&\"\nimport script from \"./changePrice.vue?vue&type=script&lang=js&\"\nexport * from \"./changePrice.vue?vue&type=script&lang=js&\"\nimport style0 from \"./changePrice.vue?vue&type=style&index=0&id=23c0a7bc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"23c0a7bc\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('23c0a7bc', component.options)\n    } else {\n      api.reload('23c0a7bc', component.options)\n    }\n    module.hot.accept(\"./changePrice.vue?vue&type=template&id=23c0a7bc&scoped=true&\", function () {\n      api.rerender('23c0a7bc', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"I:/CurProject/ES_Mobile_Manager/MobileManager/pagesBill/pages/changePrice.vue\"\nexport default component.exports","import mod from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./changePrice.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./changePrice.vue?vue&type=script&lang=js&\"","import mod from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./changePrice.vue?vue&type=style&index=0&id=23c0a7bc&lang=scss&scoped=true&\"; export default mod; export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./changePrice.vue?vue&type=style&index=0&id=23c0a7bc&lang=scss&scoped=true&\"","export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./changePrice.vue?vue&type=template&id=23c0a7bc&scoped=true&\""],"sourceRoot":""}